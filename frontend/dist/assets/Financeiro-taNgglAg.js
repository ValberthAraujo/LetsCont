import{a as p,r,j as e,l as y}from"./index-0fLGo3W8.js";import{s}from"./admin.module-BibDxh5X.js";function S(){const{user:h,token:c}=p(),m=r.useMemo(()=>!!h?.is_superuser,[h]),[l,u]=r.useState(!1),[i,x]=r.useState(""),[N,f]=r.useState(0),[n,g]=r.useState([]),j=r.useMemo(()=>{const t=n.reduce((a,d)=>a+Number(d?.quantidade||0),0),o=n.reduce((a,d)=>a+Number(d?.valor||0),0);return{totalQuantidade:t,totalValor:o}},[n]);return r.useEffect(()=>{let t=!0;async function o(){if(!(!c||!m)){u(!0),x("");try{const a=await y(c);if(!t)return;const d=Array.isArray(a)?a:Array.isArray(a?.data)?a.data:[];g(d),f(d.length)}catch(a){if(!t)return;x(a?.message||"Falha ao carregar pedidos")}finally{t&&u(!1)}}}return o(),()=>{t=!1}},[c,m]),e.jsxs("div",{className:s.loginCard,children:[e.jsx("h2",{children:"Painel Financeiro"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total de pedidos:"})," ",l?"Carregando...":N]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total de rifas vendidas:"})," ",l?"—":j.totalQuantidade,"  | ",e.jsx("strong",{children:"Arrecadação (R$):"})," ",l?"—":j.totalValor.toFixed(2)]}),i&&e.jsx("p",{className:s.error,children:i}),!l&&!i&&e.jsx("div",{className:s.tableWrap,children:e.jsxs("table",{className:s.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:s.th,children:"Criado em"}),e.jsx("th",{className:s.th,children:"Nome"}),e.jsx("th",{className:s.th,children:"Email"}),e.jsx("th",{className:s.th,children:"Qtd"}),e.jsx("th",{className:s.th,children:"Valor (R$)"}),e.jsx("th",{className:s.th,children:"Status"}),e.jsx("th",{className:s.th,children:"MP ID"})]})}),e.jsxs("tbody",{children:[n.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:s.td,children:t.created_at?new Date(t.created_at).toLocaleString():"-"}),e.jsx("td",{className:s.td,children:t.nome}),e.jsx("td",{className:s.td,children:t.email}),e.jsx("td",{className:s.td,children:t.quantidade??"-"}),e.jsx("td",{className:s.td,children:Number(t.valor||0).toFixed(2)}),e.jsx("td",{className:s.td,children:t.status}),e.jsx("td",{className:s.td,children:t.mp_payment_id||"-"})]},t.id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:`${s.td} ${s.tdCenter}`,colSpan:7,children:"Nenhum pedido encontrado."})})]})]})})]})}export{S as PanelFinanceiro,S as default};
